ğŸ”¹ What is the package module?

It is a generic interface for package management.

It automatically uses the correct package manager on the target system:

yum / dnf â†’ RedHat, CentOS, Rocky, AlmaLinux

apt â†’ Debian, Ubuntu

zypper â†’ SUSE

pkg â†’ FreeBSD

Ensures idempotency: if the package is already in the desired state, nothing changes.

ğŸ”¹ Key Parameters

name: Package name(s) to manage (string or list).

state: Desired state of the package. Common values:

present â†’ Ensure installed

latest â†’ Ensure latest version

absent â†’ Ensure removed

use: Force a specific package manager (yum, apt, dnf, etc.).

update_cache: Refresh package repo metadata before installing (like apt-get update).

ğŸ”¹ Example Playbooks
1. Install a single package
---
- name: Install httpd (Apache) on any OS
  hosts: all
  become: true
  tasks:
    - name: Ensure Apache is installed
      ansible.builtin.package:
        name: httpd
        state: present


ğŸ‘‰ On RHEL/CentOS, this installs httpd.
ğŸ‘‰ On Ubuntu/Debian, it would try to install httpd (but actual package name is apache2).

2. Install multiple packages
---
- name: Install multiple packages
  hosts: all
  become: true
  tasks:
    - name: Ensure dev tools are installed
      ansible.builtin.package:
        name:
          - git
          - curl
          - vim
        state: present

3. Update package to the latest version
---
- name: Update nginx to latest version
  hosts: all
  become: true
  tasks:
    - name: Ensure nginx is latest
      ansible.builtin.package:
        name: nginx
        state: latest

4. Remove a package
---
- name: Remove telnet if present
  hosts: all
  become: true
  tasks:
    - name: Ensure telnet is absent
      ansible.builtin.package:
        name: telnet
        state: absent

5. Install using specific package manager
---
- name: Install package with explicit manager
  hosts: all
  become: true
  tasks:
    - name: Install tree using yum
      ansible.builtin.package:
        name: tree
        state: present
        use: yum

ğŸ”¹ When to use package vs apt / yum

âœ… Use package if you want cross-platform portability.

âœ… Use apt / yum / dnf if you need distro-specific options (like repo, gpg keys, cache control).

ğŸ”¹ Comparison: package vs apt vs yum vs dnf
| Feature / Module                      | `package` (Generic)          | `apt` (Debian/Ubuntu)     | `yum` (RHEL â‰¤7, CentOS)  | `dnf` (RHEL 8+, Fedora, Rocky) |
| ------------------------------------- | ---------------------------- | ------------------------- | ------------------------ | ------------------------------ |
| **Cross-platform**                    | âœ… Yes (auto-detects manager) | âŒ No (Debian/Ubuntu only) | âŒ No (RHEL â‰¤7 only)      | âŒ No (RHEL 8+ only)            |
| **Basic ops (install/remove/update)** | âœ… Yes                        | âœ… Yes                     | âœ… Yes                    | âœ… Yes                          |
| **Update package cache**              | âŒ No                         | âœ… `update_cache: yes`     | âœ… `update_cache: yes`    | âœ… `update_cache: yes`          |
| **Install from `.deb` / `.rpm` file** | âŒ No                         | âœ… (supports `.deb`)       | âœ… (supports `.rpm`)      | âœ… (supports `.rpm`)            |
| **Enable/disable repo**               | âŒ No                         | âœ… (via `apt_repository`)  | âœ… (via `yum_repository`) | âœ… (via `dnf`)                  |
| **Security updates only**             | âŒ No                         | âœ… Yes (`only_upgrade`)    | âœ… Yes (`security: yes`)  | âœ… Yes (`security: yes`)        |
| **Best for portability?**             | âœ… Yes                        | âŒ No                      | âŒ No                     | âŒ No                           |

